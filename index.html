<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Anoma Flow Yield — Prototype</title>
  <style>
    /* -------------------------
       Variables & Base Styling
       ------------------------- */
    :root{
      --bg-color: #0b0b0e;
      --card-bg: rgba(255,255,255,0.03);
      --text: #e9e9ef;
      --muted: #b9b9bf;
      --accent: #e33a2d; /* primary red */
      --glass: rgba(255,255,255,0.04);
      --glass-2: rgba(0,0,0,0.4);
      --radius: 14px;
      --max-width: 980px;
    }

    /* Light-mode override (when body has .light) */
    body.light {
      --bg-color: #ffffff;
      --card-bg: rgba(0,0,0,0.04);
      --text: #0b0b0e;
      --muted: #55555a;
      --glass: rgba(0,0,0,0.03);
      --glass-2: rgba(255,255,255,0.6);
    }

    /* Monochrome mode (reduced color) */
    body.mono {
      --accent: #b71c1c;
    }

    *{box-sizing:border-box}
    html,body{
      height:100%;
      margin:0;
      font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: var(--bg-color) center/cover no-repeat fixed;
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Background overlay using user's background.png */
    .bg-overlay{
      position:fixed;
      inset:0;
      background-image: url('background.png');
      background-size: cover;
      background-position: center;
      opacity:0.12;
      z-index:0;
      pointer-events:none;
      mix-blend-mode:screen;
    }

    /* Main container */
    .wrap{
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:28px;
      z-index:1;
      position:relative;
    }

    .container{
      width:100%;
      max-width:var(--max-width);
      margin:0 auto;
      position:relative;
      z-index:2;
    }

    /* Header */
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      margin-bottom:22px;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:14px;
    }

    .logo{
      display:flex;
      align-items:center;
      gap:8px;
    }
    .logo .word{
      font-weight:800;
      letter-spacing:2px;
      font-size:20px;
    }
    .logo .flow{
      font-family: "Brush Script MT", Brush Script, cursive;
      color:var(--accent);
      font-size:28px;
      margin-left:6px;
    }
    .catch{
      color:var(--muted);
      font-size:12px;
      margin-top:4px;
    }

    /* Balance pill */
    .balance{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .balance .pill{
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.06));
      padding:10px 14px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.06);
      display:flex;
      gap:10px;
      align-items:center;
      font-weight:600;
    }
    .balance .xan {
      color:var(--accent);
      font-weight:800;
    }

    /* Theme toggles */
    .controls{
      display:flex;
      gap:12px;
      align-items:center;
    }
    .toggle{
      display:flex;
      gap:8px;
      align-items:center;
      font-size:13px;
      color:var(--muted);
    }
    .switch{
      width:42px;
      height:24px;
      background:var(--card-bg);
      border-radius:999px;
      padding:3px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      transition:all .18s ease;
    }
    .switch .knob{
      width:18px;height:18px;background:var(--text);border-radius:999px;transform:translateX(0);transition:all .18s ease;
    }
    .switch.on{ background:var(--accent); }
    .switch.on .knob{ transform:translateX(18px); background:white; }

    /* Card */
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.05));
      border-radius:var(--radius);
      padding:28px;
      box-shadow: 0 6px 30px rgba(0,0,0,0.45);
      border: 1px solid rgba(255,255,255,0.04);
    }

    /* Landing hero */
    .hero{
      display:flex;
      gap:28px;
      align-items:center;
      justify-content:space-between;
      padding:28px;
      background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
      border-radius:12px;
    }

    .hero-left{
      flex:1;
    }
    .hero-title{
      font-size:28px;
      font-weight:900;
      display:flex;
      align-items:baseline;
      gap:8px;
    }
    .hero-title .anoma{
      letter-spacing:4px;
      color:var(--text);
    }
    .hero-title .flow-y{
      font-family: "Brush Script MT", Brush Script, cursive;
      color:var(--accent);
      font-size:30px;
      margin-left:6px;
    }
    .hero-sub{
      margin-top:8px;
      color:var(--muted);
      font-size:14px;
    }
    .cta-row{
      margin-top:20px;
      display:flex;
      gap:12px;
      align-items:center;
    }
    .btn{
      padding:12px 18px;
      border-radius:12px;
      cursor:pointer;
      border:0;
      font-weight:700;
      font-size:14px;
    }
    .btn.primary{
      background:linear-gradient(180deg,var(--accent), #b2221a);
      color:white;
      box-shadow: 0 8px 20px rgba(227,58,45,0.12);
    }
    .btn.ghost{
      background:transparent;
      color:var(--muted);
      border:1px solid rgba(255,255,255,0.04);
    }

    /* Earning page layout */
    .earn-layout{
      display:flex;
      gap:20px;
      margin-top:20px;
      align-items:flex-start;
      flex-wrap:wrap;
    }
    .left-panel{
      flex:1 1 360px;
      min-width:260px;
    }
    .right-panel{
      width:320px;
      min-width:260px;
    }

    /* Wallet / actions */
    .wallet{
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .wallet .row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      padding:12px;
      border-radius:10px;
      background:var(--card-bg);
      border:1px solid rgba(255,255,255,0.02);
    }
    .wallet .row small{ color:var(--muted); font-size:12px; }

    /* Form controls */
    label{ font-size:13px; color:var(--muted); display:block; margin-bottom:6px; }
    input[type="number"], select{
      width:100%;
      padding:12px 12px;
      border-radius:10px;
      background:transparent;
      color:var(--text);
      border:1px solid rgba(255,255,255,0.06);
      font-size:15px;
    }

    .actions{
      display:flex;
      gap:10px;
      margin-top:12px;
    }

    .history{
      margin-top:12px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .history .item{
      padding:10px;
      border-radius:10px;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.03));
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      border:1px solid rgba(255,255,255,0.03);
    }

    /* Modal like success */
    .toast{
      position:fixed;
      left:50%;
      transform:translateX(-50%);
      bottom:20px;
      background:linear-gradient(180deg,#0b0b0e,#0f0f12);
      color:white;
      padding:12px 18px;
      border-radius:10px;
      box-shadow:0 10px 30px rgba(0,0,0,0.5);
      display:none;
      z-index:9999;
    }
    .toast.show{ display:block; animation:toastIn .28s ease; }
    @keyframes toastIn{ from{opacity:0; transform:translate(-50%,8px);} to{opacity:1; transform:translate(-50%,0);} }

    /* Small screens */
    @media (max-width:820px){
      .hero{ flex-direction:column; text-align:center; align-items:center; }
      .right-panel{ width:100% }
      .left-panel{ width:100% }
      header{ flex-direction:column; align-items:flex-start; gap:12px; }
      .balance { align-self:flex-end; }
    }

    /* Small visual tweaks for mobile buttons */
    @media (max-width:480px){
      .hero-title{ font-size:22px; }
      .logo .flow{ font-size:22px; }
      .btn{ padding:10px 14px; font-size:13px; }
    }

    body.light .card{ border:1px solid rgba(0,0,0,0.06); box-shadow:none }
  </style>
</head>
<body class="">
  <div class="bg-overlay" aria-hidden="true"></div>

  <div class="wrap">
    <div class="container">

      <!-- Header -->
      <header>
        <div class="brand">
          <div class="logo" aria-hidden="true">
            <div style="width:40px;height:40px;border-radius:8px;background:var(--glass);display:flex;align-items:center;justify-content:center;font-weight:900;color:var(--accent)">A</div>
            <div>
              <div class="word" style="font-size:16px">ANOMA <span style="opacity:.85">FLOW</span></div>
              <div class="catch" style="font-size:11px">Yield • Cross-chain optimizer</div>
            </div>
          </div>
        </div>

        <div style="display:flex;gap:12px;align-items:center;">
          <div class="balance" title="Your wallet">
            <div style="text-align:right;font-size:12px;color:var(--muted)">Balance</div>
            <div class="pill" id="balancePill">
              <div><strong id="balanceAmount">500</strong></div>
              <div class="xan">XAN</div>
            </div>
          </div>

          <div class="controls">
            <div class="toggle" title="Toggle light/dark">
              <div style="font-size:12px;color:var(--muted);">Light</div>
              <div id="themeSwitch" class="switch" role="button" aria-pressed="false" tabindex="0">
                <div class="knob"></div>
              </div>
            </div>

            <div class="toggle" title="Monochrome">
              <div style="font-size:12px;color:var(--muted);">Mono</div>
              <div id="monoSwitch" class="switch" role="button" aria-pressed="false" tabindex="0">
                <div class="knob"></div>
              </div>
            </div>
          </div>
        </div>
      </header>

      <!-- Main Card -->
      <div class="card" id="appCard">
        <!-- Landing / Hero -->
        <section id="landingView" class="hero" aria-label="Landing">
          <div class="hero-left">
            <div class="hero-title">
              <div class="anoma">ANOMA</div>
              <div class="flow-y">Flow Yield</div>
            </div>
            <div class="hero-sub" style="max-width:520px">
              <div style="font-weight:600;margin-bottom:6px">Maximize your yield, Across all chains</div>
              <div style="color:var(--muted);font-size:13px">Cross-chain aggregator prototype — deposit, earn, and withdraw. Tokens supported: USDT, USDC, XAN, ETH, SOL, BNB, BTC, and more.</div>
            </div>

            <div class="cta-row">
              <button class="btn primary" id="startBtn">Start Earning</button>
              <button class="btn ghost" id="learnBtn">How it works</button>
            </div>
          </div>

          <div style="width:320px;text-align:center;">
            <!-- visual -->
            <div style="padding:18px;border-radius:12px;background:var(--glass);">
              <img src="" alt="" style="width:100%;opacity:0.02;display:block" />
              <div style="font-size:12px;color:var(--muted)">Prototype UI</div>
            </div>
          </div>
        </section>

        <!-- Earning view (hidden initially) -->
        <section id="earningView" style="display:none; margin-top:8px;">
          <div style="display:flex;align-items:center;justify-content:space-between;">
            <div style="display:flex;flex-direction:column;">
              <div style="font-weight:800;font-size:18px">Earning Dashboard</div>
              <div style="font-size:13px;color:var(--muted)">Deposit funds, choose earning method (Stake / Lend / Liquidity), track deposits and withdraw anytime.</div>
            </div>
            <div>
              <button class="btn ghost" id="backToLanding">Back</button>
            </div>
          </div>

          <div class="earn-layout">
            <!-- left -->
            <div class="left-panel">

              <!-- Deposit card -->
              <div class="wallet card" style="padding:16px;">
                <div style="font-weight:800">Deposit</div>
                <div style="margin-top:6px;color:var(--muted);font-size:13px">Enter an amount and select token to deposit.</div>

                <div style="margin-top:12px">
                  <label for="tokenSelect">Token</label>
                  <select id="tokenSelect">
                    <option value="USDT">USDT</option>
                    <option value="USDC">USDC</option>
                    <option value="XAN">XAN</option>
                    <option value="ETH">ETH</option>
                    <option value="SOL">SOL</option>
                    <option value="BNB">BNB</option>
                    <option value="BTC">BTC</option>
                    <option value="XRP">XRP</option>
                    <option value="ADA">ADA</option>
                    <option value="HYPE">HYPE</option>
                    <option value="AVAX">AVAX</option>
                    <option value="MATIC">MATIC</option>
                    <option value="ALGA">ALGA</option>
                    <option value="NEAR">NEAR</option>
                    <option value="APT">APT</option>
                    <option value="SUI">SUI</option>
                    <option value="AAVE">AAVE</option>
                    <option value="TIA">TIA</option>
                    <option value="ARB">ARB</option>
                    <option value="COMP">COMP</option>
                    <option value="TON">TON</option>
                    <option value="TRX">TRX</option>
                  </select>
                </div>

                <div style="margin-top:12px">
                  <label for="amountInput">Amount</label>
                  <input id="amountInput" type="number" placeholder="e.g., 10" min="0" step="any" />
                </div>

                <div class="actions">
                  <button class="btn primary" id="depositBtn">Deposit</button>
                  <button class="btn ghost" id="depositXanBtn">Use XAN Balance</button>
                </div>

                <div class="history" id="depositHistory">
                  <div style="color:var(--muted);font-size:13px">Recent deposits</div>
                </div>
              </div>

              <!-- Earn yield -->
              <div class="card" style="margin-top:12px;padding:16px;">
                <div style="font-weight:800">Earn Yield</div>
                <div style="margin-top:6px;color:var(--muted);font-size:13px">Pick an earning method and continue.</div>

                <div style="margin-top:12px;display:flex;gap:8px;">
                  <label style="flex:1">
                    <input type="radio" name="earnMethod" value="Stake" checked /> Stake
                  </label>
                  <label style="flex:1">
                    <input type="radio" name="earnMethod" value="Lend" /> Lend
                  </label>
                  <label style="flex:1">
                    <input type="radio" name="earnMethod" value="Liquidity" /> Provide Liquidity
                  </label>
                </div>

                <div class="actions" style="margin-top:12px;">
                  <button class="btn primary" id="earnBtn">Earn Yield</button>
                  <button class="btn ghost" id="learnYieldBtn">Learn</button>
                </div>
              </div>

            </div>

            <!-- right -->
            <div class="right-panel">
              <div class="card" style="padding:12px;">
                <div style="display:flex;justify-content:space-between;align-items:center;">
                  <div>
                    <div style="font-weight:800">Your Wallet</div>
                    <div style="font-size:12px;color:var(--muted)">Simulated balances</div>
                  </div>
                  <div style="text-align:right;">
                    <div style="font-weight:900;font-size:18px" id="walletXan">500</div>
                    <div style="font-size:12px;color:var(--muted)">XAN</div>
                  </div>
                </div>

                <div style="margin-top:10px">
                  <div style="display:flex;gap:8px;">
                    <button class="btn ghost" id="withdrawBtn" style="flex:1">Withdraw Last</button>
                    <button class="btn ghost" id="viewDepositsBtn" style="flex:1">View Deposits</button>
                  </div>
                </div>

                <div style="margin-top:12px;color:var(--muted);font-size:13px">
                  Tip: XAN can be used to deposit and earn yield. Withdraw returns deposits back to your wallet.
                </div>
              </div>

              <div class="card" style="margin-top:12px;padding:12px;">
                <div style="font-weight:800">Activity</div>
                <div id="activityList" style="margin-top:8px;color:var(--muted);font-size:13px">No activity yet — start by depositing!</div>
              </div>
            </div>
          </div>
        </section>

      </div> <!-- end card -->
    </div>
  </div>

  <div class="toast" id="toast">Success</div>

  <script>
    /***********************************************
     * Prototype behaviour (single-file)
     ***********************************************/
    (function(){
      // Elements
      const landingView = document.getElementById('landingView');
      const earningView = document.getElementById('earningView');
      const startBtn = document.getElementById('startBtn');
      const learnBtn = document.getElementById('learnBtn');
      const backToLanding = document.getElementById('backToLanding');
      const depositBtn = document.getElementById('depositBtn');
      const depositXanBtn = document.getElementById('depositXanBtn');
      const amountInput = document.getElementById('amountInput');
      const tokenSelect = document.getElementById('tokenSelect');
      const depositHistory = document.getElementById('depositHistory');
      const walletXan = document.getElementById('walletXan');
      const balanceAmount = document.getElementById('balanceAmount');
      const earnBtn = document.getElementById('earnBtn');
      const withdrawBtn = document.getElementById('withdrawBtn');
      const viewDepositsBtn = document.getElementById('viewDepositsBtn');
      const activityList = document.getElementById('activityList');
      const toast = document.getElementById('toast');
      const themeSwitch = document.getElementById('themeSwitch');
      const monoSwitch = document.getElementById('monoSwitch');

      // State
      const state = {
        xan: 500, // initial XAN balance
        deposits: [], // { id, token, amount, method (optional), ts, fundedByXan: bool }
        activity: []
      };

      // Utils
      function showToast(msg, ms=2200){
        toast.textContent = msg;
        toast.classList.add('show');
        setTimeout(()=> toast.classList.remove('show'), ms);
      }

      function formatAmt(n){
        return (Math.round((Number(n)||0)*10000)/10000).toString();
      }

      function refreshUI(){
        walletXan.textContent = formatAmt(state.xan);
        balanceAmount.textContent = formatAmt(state.xan);
        // deposit list
        depositHistory.innerHTML = '<div style="color:var(--muted);font-size:13px">Recent deposits</div>';
        const latest = state.deposits.slice().reverse().slice(0,6);
        if(latest.length === 0){
          const e = document.createElement('div');
          e.style.color='var(--muted)';
          e.style.fontSize='13px';
          e.style.padding='8px';
          e.textContent = 'No deposits yet';
          depositHistory.appendChild(e);
        } else {
          latest.forEach(d=>{
            const it = document.createElement('div');
            it.className = 'item';
            it.innerHTML = `<div>
                              <div style="font-weight:700">${formatAmt(d.amount)} ${d.token} ${d.fundedByXan?'<span style=\"font-size:11px;color:var(--muted);margin-left:8px\">(funded by XAN)</span>':''}</div>
                              <small style="color:var(--muted)">${new Date(d.ts).toLocaleString()}</small>
                            </div>
                            <div style="text-align:right">
                              <div style="font-size:12px;color:var(--muted)">${d.method||'—'}</div>
                              <button class="btn ghost" style="margin-top:6px;padding:6px 8px;font-size:12px" data-withdraw="${d.id}">Withdraw</button>
                            </div>`;
            depositHistory.appendChild(it);
          });
        }

        // activity
        if(state.activity.length === 0){
          activityList.innerHTML = 'No activity yet — start by depositing!';
        } else {
          activityList.innerHTML = state.activity.slice().reverse().slice(0,6).map(a=>`<div style="padding:6px 0;border-bottom:1px dashed rgba(255,255,255,0.03)">${a}</div>`).join('');
        }
      }

      // simple id generator
      function id(){
        return 'd'+Math.random().toString(36).slice(2,9);
      }

      // Navigation
      startBtn.addEventListener('click', ()=> {
        landingView.style.display = 'none';
        earningView.style.display = 'block';
        showToast('Welcome — deposit to start earning');
      });

      learnBtn.addEventListener('click', ()=> {
        alert('This is a prototype UI. It simulates deposit and yield flows. No real transactions occur.');
      });

      backToLanding.addEventListener('click', ()=> {
        earningView.style.display = 'none';
        landingView.style.display = 'flex';
      });

      // Deposit normal (simulated)
      depositBtn.addEventListener('click', ()=> {
        const token = tokenSelect.value;
        const amount = parseFloat(amountInput.value);
        if(!amount || amount <= 0){
          showToast('Enter a valid amount');
          return;
        }

        // If depositing XAN directly -> reduce balance and mark fundedByXan
        if(token === 'XAN'){
          if(state.xan < amount){
            showToast('Insufficient XAN balance');
            return;
          }
          state.xan -= amount;
          const depositObj = { id: id(), token, amount: amount, ts: Date.now(), fundedByXan: true };
          state.deposits.push(depositObj);
          state.activity.push(`Deposited ${formatAmt(amount)} ${token} (from XAN)`);
          showToast(`Deposit successful — ${formatAmt(amount)} ${token}`);
          amountInput.value = '';
          refreshUI();
          return;
        }

        // Otherwise deposit other token (not funded by XAN)
        const depositObj = { id: id(), token, amount: amount, ts: Date.now(), fundedByXan: false };
        state.deposits.push(depositObj);
        state.activity.push(`Deposited ${formatAmt(amount)} ${token}`);
        showToast(`Deposit successful — ${formatAmt(amount)} ${token}`);
        amountInput.value = '';
        refreshUI();
      });

      // Deposit using XAN balance: subtract from state.xan and create deposit for chosen token funded by XAN
      depositXanBtn.addEventListener('click', ()=> {
        const token = tokenSelect.value;
        const amount = parseFloat(amountInput.value);
        if(!amount || amount <= 0){
          showToast('Enter a valid amount');
          return;
        }
        if(state.xan < amount){
          showToast('Insufficient XAN balance');
          return;
        }
        state.xan -= amount;
        const depositObj = { id: id(), token, amount: amount, ts: Date.now(), fundedByXan: true };
        state.deposits.push(depositObj);
        state.activity.push(`Deposited ${formatAmt(amount)} ${token} (funded by XAN)`);
        showToast(`Deposit successful — ${formatAmt(amount)} ${token} (from XAN)`);
        amountInput.value = '';
        refreshUI();
      });

      // Withdraw: event delegation for withdraw buttons in depositHistory
      depositHistory.addEventListener('click', (ev)=>{
        const btn = ev.target.closest('button[data-withdraw]');
        if(!btn) return;
        const did = btn.getAttribute('data-withdraw');
        const idx = state.deposits.findIndex(d=>d.id === did);
        if(idx === -1) return;
        const d = state.deposits[idx];
        // If deposit was funded by XAN, refund XAN on withdraw
        if(d.fundedByXan){
          state.xan += Number(d.amount);
          state.activity.push(`Withdrew ${formatAmt(d.amount)} ${d.token} — refunded ${formatAmt(d.amount)} XAN`);
          showToast(`Withdrew ${formatAmt(d.amount)} ${d.token} — ${formatAmt(d.amount)} XAN refunded`);
        } else {
          state.activity.push(`Withdrew ${formatAmt(d.amount)} ${d.token}`);
          showToast(`Withdrew ${formatAmt(d.amount)} ${d.token}`);
        }
        state.deposits.splice(idx,1);
        refreshUI();
      });

      // Withdraw button on right panel: withdraw last deposit
      withdrawBtn.addEventListener('click', ()=>{
        if(state.deposits.length === 0){
          showToast('No deposits to withdraw');
          return;
        }
        const d = state.deposits.pop();
        if(d.fundedByXan){
          state.xan += Number(d.amount);
          state.activity.push(`Withdrew ${formatAmt(d.amount)} ${d.token} — refunded ${formatAmt(d.amount)} XAN`);
          showToast(`Withdrew ${formatAmt(d.amount)} ${d.token} — ${formatAmt(d.amount)} XAN refunded`);
        } else {
          state.activity.push(`Withdrew ${formatAmt(d.amount)} ${d.token}`);
          showToast(`Withdrew ${formatAmt(d.amount)} ${d.token}`);
        }
        refreshUI();
      });

      // View deposits button
      viewDepositsBtn.addEventListener('click', ()=> {
        if(state.deposits.length === 0){
          alert('No active deposits');
          return;
        }
        const list = state.deposits.map((d,i)=>`${i+1}. ${formatAmt(d.amount)} ${d.token} ${d.fundedByXan?'(funded by XAN)':''} — ${new Date(d.ts).toLocaleString()}`).join('\n');
        alert('Active deposits:\n\n' + list);
      });

      // Earn Yield flow
      earnBtn.addEventListener('click', ()=>{
        const method = document.querySelector('input[name="earnMethod"]:checked').value;
        if(state.deposits.length === 0){
          showToast('No deposits yet — deposit first');
          return;
        }
        let depositList = state.deposits.map((d,i)=>`${i+1}. ${formatAmt(d.amount)} ${d.token}${d.fundedByXan?' (funded by XAN)':''}`).join('\n');
        const pick = prompt(`Select deposit to apply ${method} (enter number):\n\n${depositList}`);
        if(!pick) { showToast('Cancelled'); return; }
        const idx = Number(pick) - 1;
        if(isNaN(idx) || idx < 0 || idx >= state.deposits.length){ showToast('Invalid selection'); return; }
        state.deposits[idx].method = method;
        state.activity.push(`${method} started on ${formatAmt(state.deposits[idx].amount)} ${state.deposits[idx].token}`);
        showToast(`${method} successful for ${formatAmt(state.deposits[idx].amount)} ${state.deposits[idx].token}`);
        refreshUI();
      });

      // Misc: how to learn about earn
      document.getElementById('learnYieldBtn').addEventListener('click', ()=> {
        alert('Stake: lock tokens to earn rewards.\nLend: supply tokens to borrowers for interest.\nProvide Liquidity: add tokens to a pool to earn fees & rewards.');
      });

      // Theme switch (light/dark)
      let light = false;
      function updateTheme(){
        if(light){
          document.body.classList.add('light');
          themeSwitch.classList.add('on');
          themeSwitch.setAttribute('aria-pressed','true');
        } else {
          document.body.classList.remove('light');
          themeSwitch.classList.remove('on');
          themeSwitch.setAttribute('aria-pressed','false');
        }
      }
      themeSwitch.addEventListener('click', ()=>{
        light = !light;
        updateTheme();
      });
      themeSwitch.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' ') { e.preventDefault(); themeSwitch.click(); }});

      // Mono switch
      let mono = false;
      function updateMono(){
        if(mono){
          document.body.classList.add('mono');
          monoSwitch.classList.add('on');
          monoSwitch.setAttribute('aria-pressed','true');
        } else {
          document.body.classList.remove('mono');
          monoSwitch.classList.remove('on');
          monoSwitch.setAttribute('aria-pressed','false');
        }
      }
      monoSwitch.addEventListener('click', ()=>{ mono = !mono; updateMono(); });
      monoSwitch.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' ') { e.preventDefault(); monoSwitch.click(); }});

      // Initial render
      refreshUI();

      // Accessibility: allow pressing Enter on Deposit when cursor is in input (submit)
      amountInput.addEventListener('keydown', (e)=>{
        if(e.key === 'Enter'){ depositBtn.click(); }
      });

      // Expose state to window for debugging in prototype
      window._prototypeState = state;

    })();
  </script>
</body>
</html>
